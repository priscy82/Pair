<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Pairing Code Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .font-inter { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', Georgia, serif; }
    </style>
</head>
<body class="min-h-screen bg-[#FBFBFB] font-inter">
    <div class="flex min-h-screen">
        <!-- Vertical Utility Rail - Desktop Only -->
        <div class="hidden md:flex w-14 bg-white flex-col items-center justify-center relative z-10">
            <!-- WhatsApp brand text - rotated -->
            <div class="flex-1 flex items-center justify-center">
                <div class="transform -rotate-90 whitespace-nowrap">
                    <span class="font-inter font-semibold text-sm tracking-wider text-black">WHATSAPP</span>
                </div>
            </div>
            
            <!-- Status indicator -->
            <div class="absolute bottom-8 flex flex-col items-center space-y-3">
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                <span class="text-xs text-gray-400 transform -rotate-90 whitespace-nowrap">CONNECTED</span>
            </div>
        </div>

        <!-- Mobile horizontal utility bar -->
        <div class="md:hidden w-full bg-white flex items-center justify-between px-4 py-3 border-b border-[#E8E8E8] relative z-10">
            <span class="font-inter font-semibold text-sm tracking-wider text-black">WHATSAPP PAIRING</span>
            <div class="flex items-center space-x-2">
                <div class="w-2 h-2 rounded-full bg-green-500"></div>
                <span class="text-xs text-gray-600">Connected</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col md:flex-row">
            <!-- Left Panel - Illustration/Info -->
            <div class="flex-1 bg-[#F5F5F5] relative flex items-center justify-center md:border-r border-[#E8E8E8] min-h-[40vh] md:min-h-screen">
                <div class="text-center px-8">
                    <div class="mb-8">
                        <!-- WhatsApp-style icon -->
                        <div class="w-24 h-24 mx-auto mb-6 bg-green-500 rounded-full flex items-center justify-center">
                            <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.893 3.386"/>
                            </svg>
                        </div>
                    </div>
                    <h2 class="font-playfair font-medium text-2xl md:text-3xl text-black leading-tight mb-4">Generate Pairing Codes</h2>
                    <p class="font-inter text-sm text-[#4D4D4D] leading-6 max-w-md mx-auto">
                        Generate WhatsApp pairing codes for phone numbers. Enter a phone number and optionally specify how many codes to generate.
                    </p>
                </div>
            </div>

            <!-- Right Panel - Form -->
            <div class="flex-1 bg-[#FBFBFB] px-5 py-6 sm:px-8 sm:py-8 md:px-16 lg:px-20 md:py-16 relative">
                <!-- Header -->
                <div class="mb-6 md:mb-8">
                    <h1 class="font-playfair font-medium text-xl sm:text-2xl md:text-3xl lg:text-4xl text-black leading-tight mb-3">
                        Pairing Code Generator
                    </h1>
                    <div class="w-16 h-px bg-black"></div>
                </div>

                <!-- Form -->
                <form method="POST" action="/ui/pair" class="mb-6 md:mb-8">
                    <div class="mb-6">
                        <label for="numberInput" class="font-inter font-semibold text-sm text-black mb-3 block">
                            Phone Number
                        </label>
                        <div class="relative">
                            <input 
                                type="text" 
                                id="numberInput" 
                                name="numberInput"
                                placeholder="Enter phone number (e.g., 1234567890 or 1234567890|5 for multiple codes)"
                                class="w-full px-4 py-3 border border-[#DCDCDC] rounded-sm font-inter text-sm focus:outline-none focus:border-black focus:ring-1 focus:ring-black transition-all duration-200"
                                required
                            />
                        </div>
                        <p class="font-inter text-xs text-[#4D4D4D] mt-2">
                            Format: phone number only (e.g., 1234567890) or phone|count (e.g., 1234567890|5) for multiple codes
                        </p>
                    </div>

                    <button 
                        type="submit"
                        class="bg-black text-white font-inter font-semibold text-xs uppercase tracking-widest px-8 py-4 rounded-sm hover:bg-gray-800 active:bg-gray-900 transition-colors duration-200"
                    >
                        Generate Pairing Code(s)
                    </button>
                </form>

                <!-- Error Display -->
                <% if (error) { %>
                <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-sm">
                    <div class="flex items-center">
                        <svg class="w-4 h-4 text-red-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="font-inter text-sm text-red-700"><%= error %></span>
                    </div>
                </div>
                <% } %>

                <!-- Results Display -->
                <% if (codes && codes.length > 0) { %>
                <div class="mb-6">
                    <h3 class="font-inter font-semibold text-sm text-black mb-3">
                        Generated Pairing Code<%= codes.length > 1 ? 's' : '' %>
                    </h3>
                    <div class="w-10 h-px bg-black mb-4"></div>

                    <div class="grid gap-3">
                        <% codes.forEach((code, index) => { %>
                        <div class="bg-white border border-[#E8E8E8] rounded-sm p-4 flex items-center justify-between group hover:shadow-sm transition-shadow duration-200">
                            <div class="flex items-center space-x-3">
                                <span class="font-inter text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">
                                    #<%= index + 1 %>
                                </span>
                                <code class="font-mono text-lg font-semibold text-black tracking-wider">
                                    <%= code %>
                                </code>
                            </div>
                            <button 
                                onclick="copyToClipboard('<%= code %>', this)"
                                class="opacity-0 group-hover:opacity-100 bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded text-xs font-inter font-medium transition-all duration-200"
                            >
                                Copy
                            </button>
                        </div>
                        <% }) %>
                    </div>

                    <!-- Generate New Codes Button -->
                    <div class="mt-6">
                        <a 
                            href="/"
                            class="inline-block border border-black text-black font-inter font-semibold text-xs uppercase tracking-widest px-8 py-4 rounded-sm hover:bg-gray-100 active:bg-gray-200 transition-all duration-200"
                        >
                            Generate New Codes
                        </a>
                    </div>
                </div>
                <% } %>

                <!-- Help Section -->
                <div class="mt-8 md:absolute md:bottom-8 md:right-5 md:mt-0 lg:right-20">
                    <span class="font-inter text-xs text-black opacity-50">
                        Need help? 
                        <button onclick="toggleHelp()" class="text-black opacity-100 underline hover:no-underline hover:text-gray-700 active:text-gray-800 transition-colors">
                            View instructions
                        </button>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white rounded-lg max-w-md w-full p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="font-inter font-semibold text-lg text-black">How to Use</h3>
                <button onclick="toggleHelp()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="space-y-3 font-inter text-sm text-gray-700">
                <p><strong>Single Code:</strong> Enter just the phone number (e.g., 1234567890)</p>
                <p><strong>Multiple Codes:</strong> Use phone|count format (e.g., 1234567890|5)</p>
                <p><strong>Max Codes:</strong> You can generate up to 500 codes at once</p>
                <p><strong>Phone Format:</strong> Enter numbers only, no spaces or special characters</p>
                <p><strong>Server Status:</strong> Make sure your Express server is running on port 3000</p>
            </div>
        </div>
    </div>

    <script>
        function toggleHelp() {
            const modal = document.getElementById('helpModal');
            modal.classList.toggle('hidden');
        }

        async function copyToClipboard(text, button) {
            try {
                await navigator.clipboard.writeText(text);
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.className = button.className.replace('bg-gray-100 text-gray-700', 'bg-green-100 text-green-700');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.className = button.className.replace('bg-green-100 text-green-700', 'bg-gray-100 text-gray-700');
                }, 2000);
            } catch (err) {
                console.error('Failed to copy: ', err);
            }
        }

        // Auto-format input as user types
        document.getElementById('numberInput').addEventListener('input', function(e) {
            let value = e.target.value;
            // Remove any non-digit characters except pipe (|)
            let formatted = value.replace(/[^\d|]/g, '');
            
            // Ensure only one pipe character
            const pipeCount = (formatted.match(/\|/g) || []).length;
            if (pipeCount > 1) {
                formatted = formatted.replace(/\|.*\|/, '|');
            }
            
            e.target.value = formatted;
        });

        // Close modal when clicking outside
        document.getElementById('helpModal').addEventListener('click', function(e) {
            if (e.target === this) {
                toggleHelp();
            }
        });
    </script>
</body>
</html>
